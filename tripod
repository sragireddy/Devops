import csv

def sum_and_count_rows(input_csv_file, output_csv_file):
    try:
        with open(input_csv_file, 'r', newline='') as input_file, \
             open(output_csv_file, 'w', newline='') as output_file:
            reader = csv.DictReader(input_file)
            
            # Check if 'BAL_DIFF' column exists
            header = reader.fieldnames
            if "BAL_DIFF" not in header:
                print("Error: 'BAL_DIFF' column not found in the CSV.")
                return
            
            # Prepare output CSV writer
            output_fieldnames = ['Total Rows', 'Sum of BAL_DIFF']
            writer = csv.DictWriter(output_file, fieldnames=output_fieldnames)
            writer.writeheader()

            total_rows = 0
            total_balance_diff = 0
            
            for row in reader:
                total_rows += 1
                try:
                    balance_diff = float(row["BAL_DIFF"])
                    total_balance_diff += balance_diff
                except ValueError:
                    print(f"Error parsing 'BAL_DIFF' in row {total_rows}: {row['BAL_DIFF']}. Skipping this row.")
                    
            # Write results to the output CSV file
            writer.writerow({'Total Rows': total_rows, 'Sum of BAL_DIFF': total_balance_diff})
            print(f"Results written to {output_csv_file}")
            
    except FileNotFoundError:
        print(f"The file {input_csv_file} was not found.")
    except Exception as e:
        print(f"An error occurred: {e}")

# Example usage
input_csv_file = 'your_input_file.csv'    # Replace with your input CSV file path
output_csv_file = 'output_summary.csv'     # Replace with desired output CSV file path

sum_and_count_rows(input_csv_file, output_csv_file)

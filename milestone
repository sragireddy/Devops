import pandas as pd
from datetime import datetime, timedelta

# Read the CSV file
df = pd.read_csv('your_input_file.csv')  # Replace with the actual filename

# Convert the date column to datetime format
df['Date'] = pd.to_datetime(df['Date'])

# Define the time range for the next hour
now = datetime.now()
end_time = now + timedelta(hours=1)

found_data = False

while not found_data:
    # Check if there is data within the current time range
    filtered_df = df[(df['Date'] >= now) & (df['Date'] <= end_time)]

    # If data is found, exit the loop
    if not filtered_df.empty:
        found_data = True
    else:
        # Extend the time range to the following hour
        end_time = end_time + timedelta(hours=1)

# Save the filtered data to a new CSV file
filtered_df.to_csv('filtered_data.csv', index=False)
